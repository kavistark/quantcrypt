<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QuantCrypt - Professional Trading Portfolio</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary-color: #06b6d4;
            --secondary-color: #0f172a;
            --accent-color: #1e293b;
            --text-light: #f8fafc;
            --success-color: #10b981;
            --danger-color: #ef4444;
            --warning-color: #f59e0b;
            --gradient-primary: linear-gradient(135deg, #06b6d4 0%, #3b82f6 50%, #8b5cf6 100%);
            --gradient-secondary: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--gradient-secondary);
            color: var(--text-light);
            overflow-x: hidden;
        }

        /* Animated Background */
        .trading-background {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1; background: var(--gradient-secondary);
        }
        .trading-particles { position: absolute; width: 100%; height: 100%; overflow: hidden; }
        .particle {
            position: absolute; background: var(--primary-color); border-radius: 50%; opacity: 0.1;
            animation: float 20s infinite linear;
        }
        .particle:nth-child(1){ width:4px;height:4px;left:10%;animation-delay:0s;}
        .particle:nth-child(2){ width:6px;height:6px;left:20%;animation-delay:2s;}
        .particle:nth-child(3){ width:3px;height:3px;left:30%;animation-delay:4s;}
        .particle:nth-child(4){ width:5px;height:5px;left:40%;animation-delay:6s;}
        .particle:nth-child(5){ width:4px;height:4px;left:50%;animation-delay:8s;}
        .particle:nth-child(6){ width:6px;height:6px;left:60%;animation-delay:10s;}
        .particle:nth-child(7){ width:3px;height:3px;left:70%;animation-delay:12s;}
        .particle:nth-child(8){ width:5px;height:5px;left:80%;animation-delay:14s;}
        .particle:nth-child(9){ width:4px;height:4px;left:90%;animation-delay:16s;}

        @keyframes float {
            0% { transform: translateY(100vh) translateX(0px); opacity: 0; }
            10%,90% { opacity: 0.1; }
            100% { transform: translateY(-100px) translateX(100px); opacity: 0; }
        }

        /* Trading Chart Lines */
        .chart-lines { position: absolute; width: 100%; height: 100%; opacity: 0.05; }
        .chart-line { position: absolute; height: 2px; background: var(--primary-color); animation: chartMove 15s infinite linear; }
        .chart-line:nth-child(1){ top:20%; width:300px; animation-delay:0s; }
        .chart-line:nth-child(2){ top:40%; width:250px; animation-delay:3s; }
        .chart-line:nth-child(3){ top:60%; width:200px; animation-delay:6s; }
        .chart-line:nth-child(4){ top:80%; width:280px; animation-delay:9s; }

        @keyframes chartMove {
            0% { left: -300px; opacity: 0; }
            20%,80% { opacity: 0.05; }
            100% { left: 100%; opacity: 0; }
        }

        /* Hero Section */
        .hero-section { min-height: 100vh; display: flex; align-items: center; position: relative; overflow: hidden; }
        .hero-content { z-index: 10; position: relative; }
        .profile-container { position: relative; display: flex; align-items: center; justify-content: center; margin-bottom: 3rem; }
        .profile-image {
            width: 200px; height: 200px; border-radius: 50%; background: var(--gradient-primary);
            display: flex; align-items: center; justify-content: center; font-size: 4rem; color: white;
            box-shadow: 0 20px 40px rgba(6, 182, 212, 0.3); animation: profilePulse 3s ease-in-out infinite;
            position: relative; overflow: hidden;
        }
        .profile-image::before {
            content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            animation: shimmer 2s infinite;
        }
        @keyframes profilePulse {
            0%,100% { transform: scale(1); box-shadow: 0 20px 40px rgba(6,182,212,0.3); }
            50% { transform: scale(1.05); box-shadow: 0 25px 50px rgba(6,182,212,0.5); }
        }
        @keyframes shimmer {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }
        .profile-rings { position: absolute; width: 300px; height: 300px; border-radius: 50%; border: 2px solid rgba(6,182,212,0.2); animation: rotate 20s linear infinite; }
        .profile-rings:nth-child(2){ width:350px; height:350px; border-color: rgba(59,130,246,0.1); animation-duration:25s; animation-direction: reverse; }
        .profile-rings:nth-child(3){ width:400px; height:400px; border-color: rgba(139,92,246,0.1); animation-duration:30s; }
        @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        .hero-title {
            font-size: 3.5rem; font-weight: 800; background: var(--gradient-primary);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
            text-align: center; margin-bottom: 1rem; animation: fadeInUp 1s ease-out;
        }
        .hero-subtitle { font-size: 1.5rem; color: rgba(248,250,252,0.8); text-align: center; margin-bottom: 1rem; animation: fadeInUp 1s ease-out 0.2s both; }
        .hero-description {
            font-size: 1.1rem; color: rgba(248,250,252,0.6); text-align: center; max-width: 600px;
            margin: 0 auto 3rem; line-height: 1.6; animation: fadeInUp 1s ease-out 0.4s both;
        }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }

        /* Stats Preview */
        .stats-preview { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 2rem; margin: 4rem 0; animation: fadeInUp 1s ease-out 0.6s both; }
        .stat-card {
            background: rgba(30,41,59,0.4); border: 1px solid rgba(6,182,212,0.2); border-radius: 20px; padding: 2rem; text-align: center;
            backdrop-filter: blur(20px); transition: all 0.3s ease; position: relative; overflow: hidden;
        }
        .stat-card::before {
            content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(6,182,212,0.1), transparent); transition: left 0.5s ease;
        }
        .stat-card:hover::before { left: 100%; }
        .stat-card:hover { transform: translateY(-10px); border-color: var(--primary-color); box-shadow: 0 20px 40px rgba(6,182,212,0.2); }
        .stat-value { font-size: 2.5rem; font-weight: 700; margin-bottom: 0.5rem; position: relative; z-index: 2; }
        .stat-label { color: rgba(248,250,252,0.7); font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px; position: relative; z-index: 2; }

        /* Action Buttons */
        .action-buttons { display: flex; gap: 1.5rem; justify-content: center; animation: fadeInUp 1s ease-out 0.8s both; }
        .btn-primary-custom {
            background: var(--gradient-primary); border: none; color: white; padding: 1rem 2.5rem; border-radius: 50px; font-weight: 600; font-size: 1.1rem;
            transition: all 0.3s ease; position: relative; overflow: hidden; text-decoration: none; display: inline-flex; align-items: center; gap: 0.5rem;
        }
        .btn-primary-custom::before { content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent); transition: left 0.5s ease; }
        .btn-primary-custom:hover::before { left: 100%; }
        .btn-primary-custom:hover { transform: translateY(-3px); box-shadow: 0 15px 30px rgba(6,182,212,0.4); color: white; }

        .btn-secondary-custom {
            background: transparent; border: 2px solid var(--primary-color); color: var(--primary-color); padding: 1rem 2.5rem; border-radius: 50px; font-weight: 600; font-size: 1.1rem;
            transition: all 0.3s ease; text-decoration: none; display: inline-flex; align-items: center; gap: 0.5rem;
        }
        .btn-secondary-custom:hover { background: var(--primary-color); color: white; transform: translateY(-3px); box-shadow: 0 15px 30px rgba(6,182,212,0.3); }

        /* Floating elements */
        .floating-elements { position: absolute; width: 100%; height: 100%; pointer-events: none; overflow: hidden; }
        .floating-element {
            position: absolute; background: rgba(6,182,212,0.1); border: 1px solid rgba(6,182,212,0.3);
            border-radius: 10px; padding: 1rem; backdrop-filter: blur(10px); animation: floatElement 20s infinite linear; opacity: 0.7;
        }
        .floating-element:nth-child(1){ top:10%; right:10%; animation-delay:0s;}
        .floating-element:nth-child(2){ top:60%; left:5%; animation-delay:5s;}
        .floating-element:nth-child(3){ top:30%; right:5%; animation-delay:10s;}
        @keyframes floatElement {
            0% { transform: translateY(0px) rotate(0deg); opacity: 0; }
            10%,90% { opacity: 0.7; }
            100% { transform: translateY(-20px) rotate(5deg); opacity: 0; }
        }

        .dashboard-section { opacity: 0; transform: translateY(50px); transition: all 1s ease; }
        .dashboard-section.visible { opacity: 1; transform: translateY(0); }

        @media (max-width: 768px) {
            .hero-title { font-size: 2.5rem; }
            .hero-subtitle { font-size: 1.2rem; }
            .profile-image { width: 150px; height: 150px; font-size: 3rem; }
            .action-buttons { flex-direction: column; align-items: center; }
            .stats-preview { grid-template-columns: 1fr; gap: 1rem; }
        }

        .scroll-indicator { position: absolute; bottom: 2rem; left: 50%; transform: translateX(-50%); color: rgba(248,250,252,0.6); animation: bounce 2s infinite; }
        @keyframes bounce {
            0%,20%,50%,80%,100% { transform: translateX(-50%) translateY(0); }
            40% { transform: translateX(-50%) translateY(-10px); }
            60% { transform: translateX(-50%) translateY(-5px); }
        }
    </style>
</head>
<body>
    <!-- Animated Background -->
    <div class="trading-background">
        <div class="trading-particles">
            <div class="particle"></div><div class="particle"></div><div class="particle"></div>
            <div class="particle"></div><div class="particle"></div><div class="particle"></div>
            <div class="particle"></div><div class="particle"></div><div class="particle"></div>
        </div>
        <div class="chart-lines">
            <div class="chart-line"></div><div class="chart-line"></div><div class="chart-line"></div><div class="chart-line"></div>
        </div>
    </div>

    <!-- Hero -->
    <section class="hero-section">
        <div class="container">
            <div class="hero-content">
                <div class="profile-container">
                    <div class="profile-rings"></div>
                    <div class="profile-rings"></div>
                    <div class="profile-rings"></div>
                    <div class="profile-image"><i class="fas fa-user-tie"></i></div>
                </div>

                <h1 class="hero-title">Professional Trader – <span id="traderName">Sarveshwaaran</span></h1>
                <h2 class="hero-subtitle">Elite Trading Portfolio</h2>
                <p class="hero-description">
                    Welcome to my professional trading portfolio. Featuring advanced analytics, 
                    real-time performance metrics, and comprehensive risk management across 
                    forex and commodities markets with proven consistent profitability.
                </p>

                <!-- Stats Preview (placeholders updated by JS) -->
                <div class="stats-preview">
                    <div class="stat-card">
                        <div class="stat-value" id="netProfitValue" style="color:#10b981;">$0.00</div>
                        <div class="stat-label">Net Profit</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="totalTradesValue" style="color:#06b6d4;">0</div>
                        <div class="stat-label">Total Trades</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="winRateValue" style="color:#10b981;">0.0%</div>
                        <div class="stat-label">Win Rate</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="profitFactorValue" style="color:#06b6d4;">1.00</div>
                        <div class="stat-label">Profit Factor</div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="action-buttons">
                    <a href="#dashboard" class="btn-primary-custom" id="viewDashboard">
                        <i class="fas fa-chart-line"></i> View Portfolio Dashboard
                    </a>
                    <a href="#analytics" class="btn-secondary-custom" id="viewAnalytics">
                        <i class="fas fa-chart-pie"></i> Advanced Analytics
                    </a>
                </div>
            </div>
        </div>

        <!-- Floating elements -->
        <div class="floating-elements">
            <div class="floating-element">
                <div style="color:#10b981; font-weight:700;">XAUUSD</div>
                <div style="color:#10b981; font-size:0.9rem;">+$78.89</div>
            </div>
            <div class="floating-element">
                <div style="color:#06b6d4; font-weight:700;">BUY Signal</div>
                <div style="color:#06b6d4; font-size:0.9rem;">Technical Analysis</div>
            </div>
            <div class="floating-element">
                <div style="color:#10b981; font-weight:700;">Profit +25.8</div>
                <div style="color:#10b981; font-size:0.9rem;">Take Profit Hit</div>
            </div>
        </div>

        <!-- Scroll Indicator -->
        <div class="scroll-indicator"><i class="fas fa-chevron-down fa-2x"></i></div>
    </section>

    <!-- Dashboard Section -->
    <section class="dashboard-section" id="dashboard" style="min-height: 100vh; padding: 5rem 0; display:none;">
        <div class="container">
            <!-- Portfolio Header -->
            <div style="background: linear-gradient(135deg, rgba(6, 182, 212, 0.1) 0%, rgba(16, 185, 129, 0.1) 100%); border: 1px solid rgba(6, 182, 212, 0.3); border-radius: 20px; padding: 2rem; margin-bottom: 2rem; backdrop-filter: blur(20px);">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <h1 class="mb-2" style="color:#06b6d4;">
                            <i class="fas fa-wallet me-3"></i>Trading Portfolio Dashboard
                        </h1>
                        <p class="mb-0" style="opacity:0.75;">Real-time analysis of trading performance and risk metrics</p>
                    </div>
                    <div class="col-md-4 text-md-end">
                        <div class="d-flex flex-column align-items-md-end">
                            <span class="badge bg-success mb-2 px-3 py-2">
                                <i class="fas fa-chart-line me-1"></i>Portfolio Active
                            </span>
                            <small style="color:#94a3b8;">Last sync: <span id="lastSync">Just now</span></small>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Key Metrics Row (mirrors top, kept for layout symmetry) -->
            <div class="row g-4 mb-4">
                <div class="col-lg-3 col-md-6">
                    <div style="background: rgba(30,41,59,0.8); border: 1px solid rgba(6,182,212,0.2); border-radius: 16px; padding: 1.5rem; text-align:center;">
                        <div id="tileNetPnl" style="font-size:2.5rem; font-weight:700; margin-bottom:0.5rem; color:#10b981;">$0.00</div>
                        <div style="color:rgba(248,250,252,0.8); font-size:0.9rem; text-transform:uppercase; letter-spacing:0.5px;">Net P&L</div>
                        <small style="color:#94a3b8; display:block; margin-top:0.5rem;"><i class="fas fa-arrow-up me-1"></i>After commissions</small>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <div style="background: rgba(30,41,59,0.8); border: 1px solid rgba(6,182,212,0.2); border-radius: 16px; padding: 1.5rem; text-align:center;">
                        <div id="tileTrades" style="font-size:2.5rem; font-weight:700; margin-bottom:0.5rem; color:#06b6d4;">0</div>
                        <div style="color:rgba(248,250,252,0.8); font-size:0.9rem; text-transform:uppercase; letter-spacing:0.5px;">Total Trades</div>
                        <small style="color:#94a3b8; display:block; margin-top:0.5rem;"><span id="tileWins" style="color:#10b981;">0W</span> / <span id="tileLosses" style="color:#ef4444;">0L</span></small>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <div style="background: rgba(30,41,59,0.8); border: 1px solid rgba(6,182,212,0.2); border-radius: 16px; padding: 1.5rem; text-align:center;">
                        <div id="tileWinRate" style="font-size:2.5rem; font-weight:700; margin-bottom:0.5rem; color:#10b981;">0.0%</div>
                        <div style="color:rgba(248,250,252,0.8); font-size:0.9rem; text-transform:uppercase; letter-spacing:0.5px;">Win Rate</div>
                        <small style="color:#94a3b8; display:block; margin-top:0.5rem;"><i class="fas fa-target me-1"></i>Success ratio</small>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <div style="background: rgba(30,41,59,0.8); border: 1px solid rgba(6,182,212,0.2); border-radius: 16px; padding: 1.5rem; text-align:center;">
                        <div id="tilePF" style="font-size:2.5rem; font-weight:700; margin-bottom:0.5rem; color:#06b6d4;">1.00</div>
                        <div style="color:rgba(248,250,252,0.8); font-size:0.9rem; text-transform:uppercase; letter-spacing:0.5px;">Profit Factor</div>
                        <small style="color:#94a3b8; display:block; margin-top:0.5rem;"><i class="fas fa-balance-scale me-1"></i>Risk/Reward</small>
                    </div>
                </div>
            </div>

            <!-- Chart + Symbols -->
            <div class="row g-4">
                <div class="col-lg-8">
                    <div style="background: rgba(30,41,59,0.8); border: 1px solid rgba(6,182,212,0.2); border-radius: 16px; padding: 1.5rem;">
                        <h4 style="color:#06b6d4; font-weight:600; margin-bottom:1.5rem; display:flex; align-items:center; gap:0.5rem;">
                            <i class="fas fa-chart-area"></i> Cumulative Performance
                        </h4>
                        <canvas id="performanceChart" height="80"></canvas>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div style="background: rgba(30,41,59,0.8); border: 1px solid rgba(6,182,212,0.2); border-radius: 16px; padding: 1.5rem;">
                        <h4 style="color:#06b6d4; font-weight:600; margin-bottom:1.5rem; display:flex; align-items:center; gap:0.5rem;">
                            <i class="fas fa-coins"></i> Symbol Performance
                        </h4>
                        <div id="symbolList">
                            <!-- Filled by JS from /api/portfolio/?type=summary -> by_symbol -->
                            <div style="color:#94a3b8;">Loading symbols…</div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </section>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Utilities
        function formatCurrency(n) {
            if (n === null || n === undefined || isNaN(n)) return '$0.00';
            const sign = Number(n) >= 0 ? '' : '-';
            return `${sign}$${Math.abs(Number(n)).toFixed(2)}`;
        }

        async function fetchJSON(url) {
            const res = await fetch(url, { credentials: 'same-origin' });
            if (!res.ok) throw new Error(`HTTP ${res.status}`);
            return res.json();
        }

        // Global chart instance
        let perfChartInstance = null;

        // Render summary tiles and symbol list
        async function renderSummary() {
            try {
                const data = await fetchJSON('/api/portfolio/?type=summary');

                // Top hero tiles
                document.getElementById('netProfitValue').textContent = formatCurrency(data.net_pnl);
                document.getElementById('totalTradesValue').textContent = data.total_trades ?? 0;
                document.getElementById('winRateValue').textContent = `${(data.win_rate ?? 0).toFixed(1)}%`;

                // Dashboard tiles
                document.getElementById('tileNetPnl').textContent = formatCurrency(data.net_pnl);
                document.getElementById('tileTrades').textContent = data.total_trades ?? 0;
                document.getElementById('tileWinRate').textContent = `${(data.win_rate ?? 0).toFixed(1)}%`;
                document.getElementById('tileWins').textContent = `${data.win_trades ?? 0}W`;
                document.getElementById('tileLosses').textContent = `${data.loss_trades ?? 0}L`;

                // Simple PF estimate fallback (you can compute server-side and return)
                const winners = (data.by_symbol || []).reduce((acc, s) => acc + (s.pnl > 0 ? s.pnl : 0), 0);
                const losersAbs = Math.abs((data.by_symbol || []).reduce((acc, s) => acc + (s.pnl < 0 ? s.pnl : 0), 0));
                let pf = null;
                if (losersAbs > 0) pf = winners / losersAbs;
                document.getElementById('profitFactorValue').textContent = pf ? pf.toFixed(2) : '1.00';
                document.getElementById('tilePF').textContent = document.getElementById('profitFactorValue').textContent;

                renderSymbols(data.by_symbol || []);
            } catch (e) {
                console.error('Summary fetch failed:', e);
            }
        }

        // Render right-side symbol performance list
        function renderSymbols(list) {
            const container = document.getElementById('symbolList');
            if (!list.length) {
                container.innerHTML = '<div style="color:#94a3b8;">No symbol data.</div>';
                return;
            }
            // Sort by pnl desc
            list.sort((a,b) => (b.pnl || 0) - (a.pnl || 0));
            const html = list.slice(0, 8).map(item => {
                const pnl = Number(item.pnl || 0);
                const good = pnl >= 0;
                return `
                    <div style="display:flex; justify-content:space-between; align-items:center; padding:0.8rem 0; border-bottom:1px solid rgba(6,182,212,0.1);">
                        <div>
                            <span style="width:8px; height:8px; border-radius:50%; display:inline-block; margin-right:0.5rem; background:${good ? '#10b981' : '#ef4444'};"></span>
                            <strong>${item.symbol}</strong>
                            <small style="color:#94a3b8; margin-left:0.5rem;">${item.trades} trades</small>
                        </div>
                        <div class="text-end">
                            <div style="color:${good ? '#10b981' : '#ef4444'}; font-weight:700;">${formatCurrency(pnl)}</div>
                            <!-- Win rate per symbol would need server-side; omitted here -->
                        </div>
                    </div>
                `;
            }).join('');
            container.innerHTML = html;
        }

        // Build cumulative P&L from daily data
        async function initializeChart() {
            const el = document.getElementById('performanceChart');
            if (!el) return;
            const ctx = el.getContext('2d');

            try {
                const analytics = await fetchJSON('/api/portfolio/?type=analytics');
                const daily = analytics.daily_pnl || []; // [{day:'YYYY-MM-DD', pnl: number}]

                daily.sort((a, b) => new Date(a.day) - new Date(b.day));

                const labels = [];
                const cumulative = [];
                let run = 0;
                for (const d of daily) {
                    run += Number(d.pnl || 0);
                    labels.push(new Date(d.day).toLocaleDateString('en-US', { month: 'short', day: 'numeric' }));
                    cumulative.push(Number(run.toFixed(2)));
                }

                if (labels.length === 0) {
                    // Fallback: flat last 10 days
                    const days = 10;
                    const now = new Date();
                    for (let i = days - 1; i >= 0; i--) {
                        const dt = new Date(now);
                        dt.setDate(now.getDate() - i);
                        labels.push(dt.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }));
                        cumulative.push(0);
                    }
                }

                if (perfChartInstance) perfChartInstance.destroy();

                perfChartInstance = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels,
                        datasets: [{
                            label: 'Cumulative P&L',
                            data: cumulative,
                            borderColor: '#06b6d4',
                            backgroundColor: 'rgba(6,182,212,0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4,
                            pointBackgroundColor: '#06b6d4',
                            pointBorderColor: '#ffffff',
                            pointBorderWidth: 2,
                            pointRadius: 3
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: { display: false },
                            tooltip: {
                                backgroundColor: 'rgba(30,41,59,0.9)',
                                titleColor: '#f8fafc',
                                bodyColor: '#f8fafc',
                                borderColor: '#06b6d4',
                                borderWidth: 1,
                                callbacks: {
                                    label: function(ctx) {
                                        return `P&L: ${formatCurrency(ctx.parsed.y)}`;
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                grid: { color: 'rgba(6,182,212,0.1)' },
                                ticks: { color: '#94a3b8' }
                            },
                            y: {
                                grid: { color: 'rgba(6,182,212,0.1)' },
                                ticks: {
                                    color: '#94a3b8',
                                    callback: function(value) { return formatCurrency(value); }
                                }
                            }
                        },
                        animation: { duration: 1200, easing: 'easeInOutQuart' }
                    }
                });
            } catch (e) {
                console.error('Analytics fetch failed:', e);
            }
        }

        // UI niceties
        function showAnalyticsModal() {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed; top: 20px; right: 20px; background: linear-gradient(135deg, #06b6d4, #3b82f6);
                color: white; padding: 1rem 1.5rem; border-radius: 12px; box-shadow: 0 10px 30px rgba(6, 182, 212, 0.3);
                z-index: 10000; font-weight: 600; animation: slideIn 0.5s ease-out;
            `;
            notification.innerHTML = `
                <i class="fas fa-chart-pie me-2"></i>
                Advanced Analytics Available
                <div style="font-size: 0.9rem; opacity: 0.9; margin-top: 0.5rem;">
                    Deep dive into performance metrics, risk analysis, and trading patterns
                </div>
            `;
            document.body.appendChild(notification);

            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
                @keyframes pulse { 0%{transform:scale(1);}50%{transform:scale(1.05);}100%{transform:scale(1);} }
            `;
            document.head.appendChild(style);

            setTimeout(() => {
                notification.style.animation = 'slideIn 0.5s ease-out reverse';
                setTimeout(() => notification.remove(), 500);
            }, 5000);
        }

        function startRealTimeUpdates() {
            setInterval(() => {
                const lastSync = document.getElementById('lastSync');
                if (lastSync) lastSync.textContent = new Date().toLocaleTimeString();

                document.querySelectorAll('.badge').forEach(indicator => {
                    indicator.style.animation = 'none';
                    setTimeout(() => { indicator.style.animation = 'pulse 0.5s ease-in-out'; }, 10);
                });
            }, 30000);
        }

        // Interactions
        document.addEventListener('DOMContentLoaded', function() {
            // Initial summary
            renderSummary();

            // Buttons: show dashboard + chart
            const dashboardSection = document.getElementById('dashboard');

            function revealDashboard() {
                dashboardSection.style.display = 'block';
                dashboardSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                setTimeout(() => {
                    dashboardSection.classList.add('visible');
                    initializeChart();
                }, 300);
            }

            document.getElementById('viewDashboard').addEventListener('click', function(e) {
                e.preventDefault();
                revealDashboard();
            });

            document.getElementById('viewAnalytics').addEventListener('click', function(e) {
                e.preventDefault();
                revealDashboard();
                setTimeout(showAnalyticsModal, 400);
            });

            // Parallax background
            document.addEventListener('scroll', () => {
                const scrolled = window.pageYOffset;
                const parallax = document.querySelector('.trading-background');
                const speed = 0.5;
                if (parallax) parallax.style.transform = `translateY(${scrolled * speed}px)`;
            });

            // Mouse parallax for floating elements and avatar
            document.addEventListener('mousemove', (e) => {
                const mouseX = e.clientX / window.innerWidth;
                const mouseY = e.clientY / window.innerHeight;

                document.querySelectorAll('.floating-element').forEach((el, idx) => {
                    const speed = (idx + 1) * 0.5;
                    const x = (mouseX - 0.5) * speed;
                    const y = (mouseY - 0.5) * speed;
                    el.style.transform = `translate(${x}px, ${y}px)`;
                });

                const profileImage = document.querySelector('.profile-image');
                if (profileImage) {
                    const x = (mouseX - 0.5) * 5;
                    const y = (mouseY - 0.5) * 5;
                    profileImage.style.transform = `translate(${x}px, ${y}px) scale(1)`;
                }
            });

            // Ripple effect for buttons
            document.querySelectorAll('.btn-primary-custom, .btn-secondary-custom').forEach(button => {
                button.addEventListener('click', function(event) {
                    const ripple = document.createElement('span');
                    const rect = this.getBoundingClientRect();
                    const size = Math.max(rect.width, rect.height);
                    const x = event.clientX - rect.left - size / 2;
                    const y = event.clientY - rect.top - size / 2;

                    ripple.style.cssText = `
                        position:absolute; width:${size}px; height:${size}px; left:${x}px; top:${y}px;
                        background: rgba(255,255,255,0.3); border-radius: 50%; transform: scale(0);
                        animation: ripple 0.6s ease-out; pointer-events: none;
                    `;
                    this.appendChild(ripple);

                    const rippleStyle = document.createElement('style');
                    rippleStyle.textContent = `@keyframes ripple { to { transform: scale(2); opacity: 0; } }`;
                    document.head.appendChild(rippleStyle);

                    setTimeout(() => ripple.remove(), 650);
                });
            });

            // Live updates ticker (time badge etc.)
            startRealTimeUpdates();
        });
    </script>
</body>
</html>
