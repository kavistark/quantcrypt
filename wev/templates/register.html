{% extends 'base.html' %}
{% block title %}Register {% endblock %}

{% block content %}
<div class="container py-5 mt-5">
  <div class="section-title text-center">
    <h2>Course Registration</h2>
    <p class="lead text-muted">Join QuantCrypt's career-building programs with live projects, certificates, and job support.</p>
  </div>

  <div class="row justify-content-center">
    <div class="col-lg-6">
      <div class="service-card">
        <form method="POST" action="">
          {% csrf_token %}

          <div class="mb-3">
            <label for="name" class="form-label">Full Name</label>
            <input type="text" class="form-control" id="name" name="name" required>
          </div>

          <div class="mb-3">
            <label for="email" class="form-label">Email</label>
            <input type="email" class="form-control" id="email" name="email" required>
          </div>

          <div class="mb-3">
            <label for="phone" class="form-label">Phone Number</label>
            <input type="text" class="form-control" id="phone" name="phone" required>
          </div>

          <div class="mb-3">
            <label for="course" class="form-label">Select Course</label>
            <select class="form-select" id="course" name="course" required>
              {% for course in courses %}
                <option value="{{ course.id }}" {% if course.name == selected_course %}selected{% endif %}>{{ course.name }}</option>
              {% endfor %}
            </select>
          </div>

          <div class="mb-3">
            <label for="plan" class="form-label">Plan</label>
            <select class="form-select" id="plan" name="plan" required>
              <option value="standard" {% if selected_plan == 'standard' %}selected{% endif %}>Standard (â‚¹7,000)</option>
              <option value="advanced" {% if selected_plan == 'advanced' %}selected{% endif %}>Advanced (â‚¹11,000)</option>
            </select>
          </div>

          <div class="mb-3">
            <label for="hasRef" class="form-label">Do you have a referral code?</label>
            <select class="form-select" id="hasRef" name="hasRef">
              <option value="no">No</option>
              <option value="yes">Yes</option>
            </select>
          </div>

          <div class="mb-3">
            <label for="refcode" class="form-label">Referral Code</label>
            <input type="text" class="form-control" id="refcode" name="refcode" placeholder="Enter if applicable">
          </div>

          <div class="text-center">
            <button type="submit" class="btn btn-primary-custom">Proceed to Billing</button>
          </div>
        </form>

        <div class="mt-4">
          <h5>ðŸ’³ Quick Pay Links</h5>
          <div id="payment-links">
            <a id="link-standard" href="https://razorpay.me/@quantcryptkavi?amount=Z8CuJKPQbYU9FxwhTZ%2FuFw%3D%3D" class="btn btn-outline-custom my-1 d-block" target="_blank">Pay â‚¹7,000 - Standard Package</a>
            <a id="link-standard-ref" href="https://razorpay.me/@quantcryptkavi?amount=8PPxQ8igaplMFXmGpWPZOQ%3D%3D" class="btn btn-outline-custom my-1 d-none" target="_blank">Pay â‚¹5,699 - Standard (Referral)</a>
            <a id="link-advanced" href="https://razorpay.me/@quantcryptkavi?amount=ovwBGJmzq5DUf3PQEULjew%3D%3D" class="btn btn-outline-custom my-1 d-none" target="_blank">Pay â‚¹11,000 - Advanced Package</a>
            <a id="link-advanced-ref" href="https://razorpay.me/@quantcryptkavi?amount=0G7MD68OKe1DneG78XFs5w%3D%3D" class="btn btn-outline-custom my-1 d-none" target="_blank">Pay â‚¹9,999 - Advanced (Referral)</a>
          </div>
        </div>

      </div>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const planSelect = document.getElementById('plan');
    const refSelect = document.getElementById('hasRef');

    function updateLinks() {
      const plan = planSelect.value;
      const hasRef = refSelect.value;

      // Hide all links
      document.querySelectorAll('#payment-links a').forEach(el => el.classList.add('d-none'));

      // Show only the relevant one
      if (plan === 'standard' && hasRef === 'no') {
        document.getElementById('link-standard').classList.remove('d-none');
      } else if (plan === 'standard' && hasRef === 'yes') {
        document.getElementById('link-standard-ref').classList.remove('d-none');
      } else if (plan === 'advanced' && hasRef === 'no') {
        document.getElementById('link-advanced').classList.remove('d-none');
      } else if (plan === 'advanced' && hasRef === 'yes') {
        document.getElementById('link-advanced-ref').classList.remove('d-none');
      }
    }

    planSelect.addEventListener('change', updateLinks);
    refSelect.addEventListener('change', updateLinks);

    updateLinks(); // Initial call
  });
</script>
{% endblock %}
